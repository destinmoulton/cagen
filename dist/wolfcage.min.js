/**
 * WolfCage - A Wolfram Cellular Automata Generator.
 * @author Destin Moulton
 * @version v1.2.0
 * @link https://github.com/destinmoulton/wolfcage
 * @license MIT
 */
this.templates=this.templates||{},this.templates["generator-board"]=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<div id="wolfcage-board-container">'),i.b("\n"+r),i.b('    <div id="wolfcage-board"></div>'),i.b("\n"+r),i.b("</div>"),i.fl()},partials:{},subs:{}}),this.templates["generator-colorpicker"]=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<fieldset class="wolfcage-colorpicker-container">'),i.b("\n"+r),i.b("    <legend>Active Cell Color</legend>"),i.b("\n"+r),i.b('    <div id="wolfcage-colorpicker-active"></div>'),i.b("\n"+r),i.b('    <input type="text" '),i.b("\n"+r),i.b('           class="wolfcage-colorpicker-hexinput"'),i.b("\n"+r),i.b('           id="wolfcage-colorpicker-active-hex"/>'),i.b("\n"+r),i.b("</fieldset>"),i.b("\n"+r),i.b('<fieldset  class="wolfcage-colorpicker-container">'),i.b("\n"+r),i.b("    <legend>Border Color</legend>"),i.b("\n"+r),i.b('    <div id="wolfcage-colorpicker-border"></div>'),i.b("\n"+r),i.b('    <input type="text" '),i.b("\n"+r),i.b('           class="wolfcage-colorpicker-hexinput"'),i.b("\n"+r),i.b('           id="wolfcage-colorpicker-border-hex"/>'),i.b("\n"+r),i.b("</fieldset>"),i.b("\n"+r),i.b('<fieldset  class="wolfcage-colorpicker-container">'),i.b("\n"+r),i.b("    <legend>Inactive Cell Color</legend>"),i.b("\n"+r),i.b('    <div id="wolfcage-colorpicker-inactive"></div>'),i.b("\n"+r),i.b('    <input type="text" '),i.b("\n"+r),i.b('           class="wolfcage-colorpicker-hexinput" '),i.b("\n"+r),i.b('           id="wolfcage-colorpicker-inactive-hex"/>'),i.b("\n"+r),i.b("</fieldset>"),i.fl()},partials:{},subs:{}}),this.templates["generator-preview-cell"]=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<div class="wolfcage-generator-preview-box" >'),i.b("\n"+r),i.b('    <div class="wolfcage-generator-preview-triple-cell-container">'),i.b("\n"+r),i.b('        <div class="wolfcage-generator-preview-cell wolfcage-generator-preview-cell-left '),i.s(i.f("leftBitActive",e,t,1),e,t,0,220,258,"{{ }}")&&(i.rs(e,t,function(e,t,r){r.b("wolfcage-generator-preview-cell-active")}),e.pop()),i.b('"></div>'),i.b("\n"+r),i.b('        <div class="wolfcage-generator-preview-cell wolfcage-generator-preview-cell-middle '),i.s(i.f("middleBitActive",e,t,1),e,t,0,396,434,"{{ }}")&&(i.rs(e,t,function(e,t,r){r.b("wolfcage-generator-preview-cell-active")}),e.pop()),i.b('"></div>'),i.b("\n"+r),i.b('        <div class="wolfcage-generator-preview-cell wolfcage-generator-preview-cell-right '),i.s(i.f("rightBitActive",e,t,1),e,t,0,572,610,"{{ }}")&&(i.rs(e,t,function(e,t,r){r.b("wolfcage-generator-preview-cell-active")}),e.pop()),i.b('"></div>'),i.b("\n"+r),i.b("    </div>"),i.b("\n"+r),i.b('    <div class="wolfcage-generator-preview-result-cell-container">'),i.b("\n"+r),i.b('        <div id="wolfcage-generator-preview-'),i.b(i.v(i.f("previewIndex",e,t,0))),i.b('"'),i.b("\n"+r),i.b('            class="wolfcage-generator-preview-cell wolfcage-generator-preview-cell-middle"></div>'),i.b("\n"+r),i.b('        <div id="wolfcage-generator-preview-digit-'),i.b(i.v(i.f("previewIndex",e,t,0))),i.b('"'),i.b("\n"+r),i.b('            class="wolfcage-generator-preview-digit"></div>'),i.b("\n"+r),i.b("    </div>"),i.b("\n"+r),i.b("</div>"),i.fl()},partials:{},subs:{}}),this.templates.generator=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<div id="wolfcage-generator-container">'),i.b("\n"+r),i.b('    <div id="wolfcage-generator-options" class="well">'),i.b("\n"+r),i.b('      <div class="wolfcage-generator-box">'),i.b("\n"+r),i.b('        <div class="form-inline">'),i.b("\n"+r),i.b('          Rule&nbsp;<select id="wolfcage-generator-select-input" class="form-control input-sm"></select> &nbsp;'),i.b("\n"+r),i.b('          <button id="wolfcage-generator-generate-button" class="btn btn-default btn-sm">Generate</button> &nbsp;'),i.b("\n"+r),i.b('          <button id="wolfcage-generator-colorpicker-button" class="btn btn-default btn-sm">Color</button>'),i.b("\n"+r),i.b("        </div>"),i.b("\n"+r),i.b("      </div>"),i.b("\n"),i.b("\n"+r),i.b('      <div id="wolfcage-rules-preview-container"></div>'),i.b("\n"+r),i.b('      <div class="wolfcage-generator-box" style="float:right;"></div>'),i.b("\n"+r),i.b('      <div id="wolfcage-generatemessage-container">Generating Cellular Automata...</div>'),i.b("\n"+r),i.b('      <div id="wolfcage-colorpicker" class="cp cp-small"></div>'),i.b("\n"+r),i.b("    </div>"),i.b("\n"+r),i.b('    <div id="wolfcage-generator-board"></div>'),i.b("\n"+r),i.b("  </div>"),i.fl()},partials:{},subs:{}}),this.templates["rowed-editor-cell"]=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b("<!-- Top Row Editor - Cells that compose the lower, numbered, row -->"),i.b("\n"+r),i.b('<div id="'),i.b(i.v(i.f("id",e,t,0))),i.b('" class="rowed-editor-cell" style="left:'),i.b(i.v(i.f("left",e,t,0))),i.b('px;"></div>'),i.fl()},partials:{},subs:{}}),this.templates["rowed-slider-cell"]=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b("<!-- Top Row Editor - Cells that compose the upper small preview row -->"),i.b("\n"+r),i.b('<div id="'),i.b(i.v(i.f("id",e,t,0))),i.b('" style="left:'),i.b(i.v(i.f("left",e,t,0))),i.b('px;" class="wolfcage-board-cell '),i.b(i.v(i.f("activeClass",e,t,0))),i.b('"></div>'),i.fl()},partials:{},subs:{}}),this.templates.tabs=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<li role="presentation" '),i.b("\n"+r),i.b('    class="active" '),i.b("\n"+r),i.b('    id="wolfcage-tab-thumbnails" '),i.b("\n"+r),i.b('    data-tab-module="thumbnails"><a href="#">Thumbnails</a></li>'),i.b("\n"+r),i.b('<li role="presentation" '),i.b("\n"+r),i.b('    id="wolfcage-tab-toproweditor" '),i.b("\n"+r),i.b('    data-tab-module="toproweditor"><a href="#">Top Row Editor</a></li>'),i.b("\n"+r),i.b('<li role="presentation" '),i.b("\n"+r),i.b('    id="wolfcage-tab-generator" '),i.b("\n"+r),i.b('    data-tab-module="generator"><a href="#">Generator</a></li>'),i.fl()},partials:{},subs:{}}),this.templates.thumbnails=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.s(i.f("ruleList",e,t,1),e,t,0,13,248,"{{ }}")&&(i.rs(e,t,function(e,t,i){i.b('<div class="wolfcage-rulethumb-box"'),i.b("\n"+r),i.b('     data-rule="'),i.b(i.v(i.d(".",e,t,0))),i.b('">'),i.b("\n"+r),i.b('    <img src="'),i.b(i.v(i.f("path",e,t,0))),i.b("rule_"),i.b(i.v(i.d(".",e,t,0))),i.b('.png"'),i.b("\n"+r),i.b('        class="wolfcage-rulethumb-img"'),i.b("\n"+r),i.b('        data-rule="'),i.b(i.v(i.d(".",e,t,0))),i.b('"/>'),i.b("\n"+r),i.b('    <div class="wolfcage-rulethumb-rulenum">'),i.b(i.v(i.d(".",e,t,0))),i.b("</div>"),i.b("\n"+r),i.b("</div>"),i.b("\n"+r)}),e.pop()),i.fl()},partials:{},subs:{}}),this.templates.toproweditor=new Hogan.Template({code:function(e,t,r){var i=this;return i.b(r=r||""),i.b('<div id="rowed-container">'),i.b("\n"+r),i.b('    <div id="rowed-slider-container">'),i.b("\n"+r),i.b('        <div id="rowed-slider"'),i.b("\n"+r),i.b('                data-toggle="tooltip"'),i.b("\n"+r),i.b('                data-placement="right"'),i.b("\n"+r),i.b('                title="Click to Start Dragging">'),i.b("\n"+r),i.b('            <div id="rowed-slider-arrow-left"'),i.b("\n"+r),i.b('                class="glyphicon glyphicon-chevron-left"'),i.b("\n"+r),i.b('                aria-hidden="true"></div>'),i.b("\n"+r),i.b('            <div id="rowed-slider-arrow-right"'),i.b("\n"+r),i.b('                class="glyphicon glyphicon-chevron-right"'),i.b("\n"+r),i.b('                aria-hidden="true"></div>'),i.b("\n"+r),i.b("        </div>"),i.b("\n"+r),i.b("        "),i.b("\n"+r),i.b('        <div id="rowed-slider-row-container"></div>'),i.b("\n"+r),i.b("    </div>"),i.b("\n"+r),i.b('    <div id="rowed-editor-container"></div>'),i.b("\n"+r),i.b('    <div id="rowed-button-container">'),i.b("\n"+r),i.b('        <button id="rowed-button-generate"'),i.b("\n"+r),i.b('                class="btn btn-default btn-sm">Generate</button>'),i.b("\n"+r),i.b("        &nbsp;&nbsp;&nbsp;"),i.b("\n"+r),i.b('        <button id="rowed-button-resetrow"'),i.b("\n"+r),i.b('                class="btn btn-default btn-sm">Reset Row</button>'),i.b("\n"+r),i.b("    </div>"),i.b("\n"+r),i.b("</div>"),i.fl()},partials:{},subs:{}});var Bus,bind=function(e,t){return function(){return e.apply(t,arguments)}};Bus=function(){function e(){this.subscribe=bind(this.subscribe,this),this._channels={},this._vault={}}return e.prototype.subscribe=function(e,t){return this._channels.hasOwnProperty(e)||(this._channels[e]=[]),this._channels[e].push(t)},e.prototype.broadcast=function(e,t){var r,i,o,n,l;if(this._channels.hasOwnProperty(e)){for(o=this._channels[e],n=[],r=0,i=o.length;r<i;r++)l=o[r],n.push(l(t));return n}return console.log("Bus: Unable to find "+e+" channel.")},e.prototype.set=function(e,t){return this._vault[e]=t},e.prototype.get=function(e){return this._vault.hasOwnProperty(e)?this._vault[e]:console.log("Bus: Unable to find "+e+" in variable vault.")},e}();var DOM;DOM=function(){function e(){}return e.ids={BOARD:{CONTAINER:"wolfcage-board",MESSAGE_CONTAINER:"wolfcage-generatemessage-container"},WOLFCAGE:{MAIN_CONTAINER:"wolfcage-container"},GENERATOR:{CONTENT_CONTAINER:"wolfcage-generator-board",BOARD:"wolfcage-board",RULE_PREVIEW_CONTAINER:"wolfcage-rules-preview-container",RULE_DROPDOWN:"wolfcage-generator-select-input",RULE_GENERATE_BUTTON:"wolfcage-generator-generate-button",COLORPICKER_BUTTON:"wolfcage-generator-colorpicker-button",COLORPICKER_CONTAINER:"wolfcage-colorpicker",COLORPICKER_ACTIVE:"wolfcage-colorpicker-active",COLORPICKER_BORDER:"wolfcage-colorpicker-border",COLORPICKER_INACTIVE:"wolfcage-colorpicker-inactive",COLORPICKER_ACTIVE_HEX:"wolfcage-colorpicker-active-hex",COLORPICKER_BORDER_HEX:"wolfcage-colorpicker-border-hex",COLORPICKER_INACTIVE_HEX:"wolfcage-colorpicker-inactive-hex"},TABS:{CONTAINER:"wolfcage-tab-container"},TOPROWEDITOR:{BUTTON_GENERATE:"rowed-button-generate",BUTTON_RESET:"rowed-button-resetrow",EDITOR_CONTAINER:"rowed-editor-container",ROW_CONTAINER:"rowed-slider-row-container",SLIDER_CONTAINER:"rowed-slider-container",SLIDER:"rowed-slider",SLIDER_ARROW_LEFT:"rowed-slider-arrow-left",SLIDER_ARROW_RIGHT:"rowed-slider-arrow-right"}},e.classes={BOARD:{CELL_ACTIVE_CLASS:"wolfcage-board-cell-active",CELL_BASE_CLASS:"wolfcage-board-cell"},GENERATOR:{RULE_PREVIEW_CELL_ACTIVE:"wolfcage-generator-preview-cell-active"},TABS:{ACTIVE:"active"},THUMBNAILS:{THUMB_BOX:"wolfcage-rulethumb-box"},TOPROWEDITOR:{EDITOR_CELL:"rowed-editor-cell",EDITOR_CELL_ACTIVE:"rowed-editor-cell-active",SLIDER_CELL_ACTIVE:"wolfcage-board-cell-active"}},e.prefixes={BOARD:{CELL:"sb_"},GENERATOR:{RULE_PREVIEW_CELL:"wolfcage-generator-preview-",RULE_PREVIEW_DIGIT:"wolfcage-generator-preview-digit-"},TABS:{TAB_PREFIX:"wolfcage-tab-"},TOPROWEDITOR:{SLIDER_COL:"rowed-slider-col-"}},e.elemById=function(e,t){return document.getElementById(this.getID(e,t))},e.elemByPrefix=function(e,t,r){return document.getElementById(this.getPrefix(e,t)+r)},e.getClass=function(e,t){return this.classes[e][t]},e.getID=function(e,t){return this.ids.hasOwnProperty(e)?this.ids[e].hasOwnProperty(t)?this.ids[e][t]:void console.log("DOM::getID() - Unable to find `"+t+"`"):void console.log("DOM::getID() - Unable to find `"+e+"`")},e.getPrefix=function(e,t){return this.prefixes[e][t]},e}();var Board;Board=function(){function e(e){this.BUS=e,this._boardNoCellsWide=0,this._boardNoCellsHigh=0,this._boardCellWidthPx=5,this._boardCellHeightPx=5,this._currentRow=1,this._rootRowBinary=[],this._currentCells=[],this._RuleMatcher=new RuleMatcher(e),this._setupColorChangeEvents()}return e.prototype.buildBoard=function(e,t,r){return this._boardElem=document.getElementById(DOM.getID("BOARD","CONTAINER")),this._messageElem=document.getElementById(DOM.getID("BOARD","MESSAGE_CONTAINER")),this._rootRowBinary=e,this._RuleMatcher.setCurrentRule(this.BUS.get("currentruledecimal")),this._boardNoCellsWide=t,this._boardNoCellsHigh=r,this._boardElem.innerWidth=t*this._boardCellWidthPx,this._boardElem.innerHeight=r*this._boardCellHeightPx,this._boardElem.innerHtml="",this._boardElem.style.display="none",this._currentRow=1,this._messageElem.style.display="block",setTimeout(function(e){return function(){return e._generateRows(),e._messageElem.style.display="none",e._boardElem.style.display="block"}}(this),500)},e.prototype._setupColorChangeEvents=function(){return this.BUS.subscribe("change.cell.style.activebackground",function(e){return function(t){e._changeCellActiveBackroundColor(t)}}(this)),this.BUS.subscribe("change.cell.style.bordercolor",function(e){return function(t){return e._changeCellBorderColor(t)}}(this)),this.BUS.subscribe("change.cell.style.inactivebackground",function(e){return function(t){return e._changeCellInactiveBackgroundColor(t)}}(this))},e.prototype._generateRows=function(){var e,t,r,i;for(this._buildTopRow(),r=[],i=e=2,t=this._boardNoCellsHigh;2<=t?e<=t:e>=t;i=2<=t?++e:--e)this._currentRow=i,r.push(this._buildRow(i));return r},e.prototype._buildRow=function(e){var t,r,i,o,n,l;for(t=r=1,o=this._boardNoCellsWide;1<=o?r<=o:r>=o;t=1<=o?++r:--r)l=this._currentCells[e-1][t-1],void 0===l&&(l=this._currentCells[e-1][this._boardNoCellsWide]),i=this._currentCells[e-1][t],n=this._currentCells[e-1][t+1],void 0===n&&(n=this._currentCells[e-1][1]),0===this._RuleMatcher.match(l,i,n)?this._getCellHtml(e,t,!1):this._getCellHtml(e,t,!0);return this._currentRow++},e.prototype._buildTopRow=function(){var e,t,r,i;for(t=r=1,i=this._boardNoCellsWide;1<=i?r<=i:r>=i;t=1<=i?++r:--r)e=this._rootRowBinary[t],1===e?this._getCellHtml(this._currentRow,t,!0):this._getCellHtml(this._currentRow,t,!1);return this._currentRow++},e.prototype._getCellHtml=function(e,t,r){var i,o,n,l,s;return this._currentCells[e]||(this._currentCells[e]=[]),this._currentCells[e][t]=r?1:0,n=DOM.getPrefix("BOARD","CELL")+this._currentRow+"_"+t,l=(t-1)*this._boardCellWidthPx,s=(e-1)*this._boardCellHeightPx,i=document.createElement("div"),i.setAttribute("id",n),i.style.top=s+"px",i.style.left=l+"px",o=DOM.getClass("BOARD","CELL_BASE_CLASS"),r?(i.style.backgroundColor=this.BUS.get("board.cell.style.activeBackgroundColor"),o+=" "+DOM.getClass("BOARD","CELL_ACTIVE_CLASS")):i.style.backgroundColor=this.BUS.get("board.cell.style.inactiveBackgroundColor"),i.setAttribute("class",""+o),i.style.borderColor=this.BUS.get("board.cell.style.borderColor"),this._boardElem.appendChild(i)},e.prototype._changeCellActiveBackroundColor=function(e){var t,r,i,o,n;for(this.BUS.set("board.cell.style.activeBackgroundColor",e),r=document.querySelectorAll("."+DOM.getClass("BOARD","CELL_ACTIVE_CLASS")),n=[],i=0,o=r.length;i<o;i++)t=r[i],n.push(t.style.backgroundColor=e);return n},e.prototype._changeCellBorderColor=function(e){var t,r,i,o,n;for(this.BUS.set("board.style.borderColor",e),this.BUS.set("board.cell.style.borderColor",e),DOM.elemById("GENERATOR","BOARD").style.borderColor=e,r=document.querySelectorAll("."+DOM.getClass("BOARD","CELL_BASE_CLASS")),n=[],i=0,o=r.length;i<o;i++)t=r[i],n.push(t.style.borderColor=e);return n},e.prototype._changeCellInactiveBackgroundColor=function(e){var t,r,i,o,n;for(this.BUS.set("board.cell.style.inactiveBackgroundColor",e),r=document.querySelectorAll("."+DOM.getClass("BOARD","CELL_BASE_CLASS")),n=[],i=0,o=r.length;i<o;i++)t=r[i],t.classList.contains(DOM.getClass("BOARD","CELL_ACTIVE_CLASS"))?n.push(void 0):n.push(t.style.backgroundColor=e);return n},e}();var Generator;Generator=function(){function e(e,t){this.BUS=e,this.multiColorPicker=t,this._currentRule=0,this._previewBoxWidth=40,this._noBoardColumns=151,this._noBoardRows=75,this._ruleList=[],this.BUS.set("currentruledecimal",this._currentRule),this.BUS.subscribe("generator.run",function(e){return function(){e.run()}}(this))}return e.prototype.run=function(){var e;return e=DOM.elemById("WOLFCAGE","MAIN_CONTAINER"),e.innerHTML=templates.generator.render({}),this._Board=new Board(this.BUS),this._setupRuleDropdown(),this._isColorPickerEnabled=!1,DOM.elemById("GENERATOR","COLORPICKER_BUTTON").addEventListener("click",function(e){return function(){return e._isColorPickerEnabled?(e._isColorPickerEnabled=!1,e.multiColorPicker.disableColorPicker()):(e._isColorPickerEnabled=!1,e.multiColorPicker.enableColorPicker())}}(this)),this._buildBoard(),!0},e.prototype._setupRuleDropdown=function(){var e,t,r,i;for(e=DOM.elemById("GENERATOR","RULE_DROPDOWN"),r="",i=t=0;t<=255;i=++t)r+="<option value='"+i+"'>"+i+"</option>";return e.innerHTML=r,e.value=this.BUS.get("currentruledecimal"),e.addEventListener("change",function(e){return function(t){return e.BUS.set("currentruledecimal",t.target.value)}}(this)),DOM.elemById("GENERATOR","RULE_GENERATE_BUTTON").addEventListener("click",function(e){return function(){return e._buildBoard()}}(this))},e.prototype._buildBoard=function(){var e;return DOM.elemById("GENERATOR","CONTENT_CONTAINER").innerHTML=templates["generator-board"].render({}),this._rulesContainerElem=DOM.elemById("GENERATOR","RULE_PREVIEW_CONTAINER"),e=this.BUS.get("toprowbinary"),this._Board.buildBoard(e,this._noBoardColumns,this._noBoardRows),this._buildRulePreview(),!0},e.prototype._buildRulePreview=function(){var e,t,r,i,o,n,l,s,a,c,d,u;for(t=this.BUS.get("rulebinarysting"),this._rulesContainerElem.innerHTML="",c=[],i=r=7;r>=0;i=--r)e=i.toString(2),2===e.length?e="0"+e:1===e.length&&(e="00"+e),s=!1,a=!1,d=!1,"1"===e.charAt(0)&&(s=!0),"1"===e.charAt(1)&&(a=!0),"1"===e.charAt(2)&&(d=!0),l=(7-i)*this._previewBoxWidth,u={left:l,previewIndex:i,leftBitActive:s,middleBitActive:a,rightBitActive:d},this._rulesContainerElem.innerHTML+=templates["generator-preview-cell"].render(u),o=DOM.elemByPrefix("GENERATOR","RULE_PREVIEW_CELL",i),n=DOM.elemByPrefix("GENERATOR","RULE_PREVIEW_DIGIT",i),o.classList.remove(DOM.getClass("GENERATOR","RULE_PREVIEW_CELL_ACTIVE")),n.innerHTML="0","1"===t.substr(7-i,1)?(o.classList.add(DOM.getClass("GENERATOR","RULE_PREVIEW_CELL_ACTIVE")),c.push(n.innerHTML="1")):c.push(void 0);return c},e}();var MultiColorPicker;MultiColorPicker=function(){function e(e){this.BUS=e}return e.prototype._setColorPickersHex=function(){return DOM.elemById("GENERATOR","COLORPICKER_ACTIVE_HEX").value=this.BUS.get("board.cell.style.activeBackgroundColor"),DOM.elemById("GENERATOR","COLORPICKER_BORDER_HEX").value=this.BUS.get("board.cell.style.borderColor"),DOM.elemById("GENERATOR","COLORPICKER_INACTIVE_HEX").value=this.BUS.get("board.cell.style.inactiveBackgroundColor")},e.prototype.enableColorPicker=function(){var e,t,r,i;return e=DOM.elemById("GENERATOR","COLORPICKER_CONTAINER"),e.innerHTML=templates["generator-colorpicker"].render({}),e.style.display="block",this._setColorPickersHex(),t=ColorPicker(DOM.elemById("GENERATOR","COLORPICKER_ACTIVE"),function(e){return function(t){return e.BUS.broadcast("change.cell.style.activebackground",t),e._setColorPickersHex()}}(this)),t.setHex(this.BUS.get("board.cell.style.activeBackgroundColor")),r=ColorPicker(DOM.elemById("GENERATOR","COLORPICKER_BORDER"),function(e){return function(t){return e.BUS.broadcast("change.cell.style.bordercolor",t),e._setColorPickersHex()}}(this)),r.setHex(this.BUS.get("board.cell.style.borderColor")),i=ColorPicker(DOM.elemById("GENERATOR","COLORPICKER_INACTIVE"),function(e){return function(t){return e.BUS.broadcast("change.cell.style.inactivebackground",t),e._setColorPickersHex()}}(this)),i.setHex(this.BUS.get("board.cell.style.inactiveBackgroundColor")),DOM.elemById("GENERATOR","COLORPICKER_ACTIVE_HEX").addEventListener("input",function(e){return function(r){return e.BUS.broadcast("change.cell.style.activebackground",r.target.value),t.setHex(r.target.value)}}(this)),DOM.elemById("GENERATOR","COLORPICKER_BORDER_HEX").addEventListener("input",function(e){return function(t){return e.BUS.broadcast("change.cell.style.bordercolor",t.target.value),r.setHex(t.target.value)}}(this)),DOM.elemById("GENERATOR","COLORPICKER_INACTIVE_HEX").addEventListener("input",function(e){return function(t){return e.BUS.broadcast("change.cell.style.inactivebackground",t.target.value),i.setHex(t.target.value)}}(this))},e.prototype.disableColorPicker=function(){var e;return e=DOM.elemById("GENERATOR","COLORPICKER_CONTAINER"),e.innerHTML="",e.style.display="none"},e}();var RuleMatcher;RuleMatcher=function(){function e(e){this.BUS=e,this._binaryRule="",this._patterns=["111","110","101","100","011","010","001","000"],this.BUS.set("rulebinarysting",this._binaryRule)}return e.prototype.setCurrentRule=function(e){return this._binaryRule=this._decToBinary(e),this.BUS.set("rulebinarysting",this._binaryRule)},e.prototype.match=function(e,t,r){var i,o;return o=""+e+t+r,i=this._patterns.indexOf(o),parseInt(this._binaryRule.substr(i,1))},e.prototype._decToBinary=function(e){var t,r,i,o;if(t=parseInt(e).toString(2),(i=t.length)<8)for(r=o=i;o<=7?r<=7:r>=7;o<=7?++r:--r)t="0"+t;return t},e}();var Thumbnails;Thumbnails=function(){function e(e){this.BUS=e,this.BUS.subscribe("thumbnails.run",function(e){return function(){e.run()}}(this))}return e.prototype.run=function(){var e,t,r,i,o,n,l,s,a;for(l=function(){for(o=[],t=0;t<=255;t++)o.push(t);return o}.apply(this),s={ruleList:l,path:this.BUS.get("thumbnails.path")},DOM.elemById("WOLFCAGE","MAIN_CONTAINER").innerHTML=templates.thumbnails.render(s),a=document.querySelectorAll("."+DOM.getClass("THUMBNAILS","THUMB_BOX")),n=[],e=r=0,i=a.length-1;0<=i?r<=i:r>=i;e=0<=i?++r:--r)n.push(a[e].addEventListener("click",function(e){return function(t){return e._ruleThumbClicked(t)}}(this)));return n},e.prototype._ruleThumbClicked=function(e){var t;return t=e.target.getAttribute("data-rule"),this.BUS.set("currentruledecimal",t),this.BUS.broadcast("tabs.show.generator")},e}();var Tabs,bind=function(e,t){return function(){return e.apply(t,arguments)}};Tabs=function(){function e(e){this._runTabModule=bind(this._runTabModule,this),this.BUS=e,this._tabsElems=[]}return e.prototype.start=function(){var e,t,r,i,o,n;for(n=DOM.elemById("TABS","CONTAINER"),n.innerHTML=templates.tabs.render({}),this._tabsElems=n.querySelectorAll("li"),r=this._tabsElems,i=[],e=0,t=r.length;e<t;e++)o=r[e],i.push(function(e){return function(t){var r;return r=t.getAttribute("data-tab-module"),t.className===DOM.getClass("TABS","ACTIVE")&&e._runTabModule(r),e.BUS.subscribe("tabs.show."+r,function(){return e._runTabModule(r)}),t.addEventListener("click",function(t){e.BUS.broadcast("tabs.show."+r)})}}(this)(o));return i},e.prototype._activateTab=function(e){var t,r,i,o,n;for(t=DOM.getClass("TABS","ACTIVE"),o=this._tabsElems,r=0,i=o.length;r<i;r++)n=o[r],n.classList.remove(t);return DOM.elemByPrefix("TABS","TAB_PREFIX",e).classList.add(t)},e.prototype._runTabModule=function(e){return this._activateTab(e),this.BUS.broadcast(e+".run")},e}();var TopRowEditor,bind=function(e,t){return function(){return e.apply(t,arguments)}};TopRowEditor=function(){function e(e){this._toggleEditorCell=bind(this._toggleEditorCell,this),this._moveSlider=bind(this._moveSlider,this),this.BUS=e,this._editorCellsElems=[],this._aRowBinary=[],this._noColumns=151,this._colWidth=5,this._rowHeight=5,this._sliderLeft=0,this._sliderCols=26,this._sliderPxToMid=this._sliderCols/2*this._colWidth,this._editorCellWidth=29,this._totalWidth=this._colWidth*this._noColumns+2,this._generateInitialBinary(),this.BUS.subscribe("toproweditor.run",function(e){return function(){e.run()}}(this))}return e.prototype.run=function(){return this._setupContainerTemplate(),this._sliderElem=DOM.elemById("TOPROWEDITOR","SLIDER"),this._rowContainerElem=DOM.elemById("TOPROWEDITOR","ROW_CONTAINER"),this._jEditorContainer=DOM.elemById("TOPROWEDITOR","EDITOR_CONTAINER"),this._rowContainerElem.style.height=this._rowHeight+"px",this._rowContainerElem.style.width=this._totalWidth+"px",this._setupSlider(),this._buildRow(),this._buildEditorCells(),this._updateEditorCells(1),this._setupButtonEvents()},e.prototype._setupContainerTemplate=function(){var e;return e=DOM.elemById("WOLFCAGE","MAIN_CONTAINER"),e.innerHTML=templates.toproweditor.render({})},e.prototype._setupSlider=function(){var e,t,r,i;return i=DOM.elemById("TOPROWEDITOR","SLIDER_CONTAINER"),i.style.width=this._totalWidth+"px",this._sliderElem.style.width=this._colWidth*this._sliderCols+"px",t=DOM.elemById("TOPROWEDITOR","SLIDER_ARROW_LEFT"),r=DOM.elemById("TOPROWEDITOR","SLIDER_ARROW_RIGHT"),e=!1,this._sliderElem.addEventListener("click",function(i){return function(){return e?(e=!1,t.style.display="none",r.style.display="none"):(e=!0,t.style.display="block",r.style.display="block")}}()),this._sliderElem.addEventListener("mousemove",function(t){return function(r){if(e)return t._moveSlider(r)}}(this)),this._sliderInitialOffset=this._getOffsetPosition(this._sliderElem)},e.prototype._setupButtonEvents=function(){return DOM.elemById("TOPROWEDITOR","BUTTON_GENERATE").addEventListener("click",function(e){return function(){e.BUS.broadcast("tabs.show.generator")}}(this)),DOM.elemById("TOPROWEDITOR","BUTTON_RESET").addEventListener("click",function(e){return function(t){return e._resetRow(t)}}(this))},e.prototype._getOffsetPosition=function(e){var t,r;return r=e.getBoundingClientRect().top+window.pageYOffset,t=e.getBoundingClientRect().left+window.pageXOffset,{top:r,left:t}},e.prototype._resetRow=function(e){return this._generateInitialBinary(),this.run()},e.prototype._moveSlider=function(e){var t,r,i,o,n,l;if(l=e.pageX-this._sliderInitialOffset.left,t=l-l%this._colWidth,i=t-this._sliderPxToMid,i<0&&(i=0),o=t+this._sliderPxToMid+this._colWidth,n=this._totalWidth+this._colWidth,i>=0&&o<=n)return this._sliderElem.style.left=i+"px",r=i/this._colWidth+1,this._updateEditorCells(r)},e.prototype._updateEditorCells=function(e){var t,r,i,o,n;for(n=[],t=i=1,o=this._sliderCols;1<=o?i<=o:i>=o;t=1<=o?++i:--i)r=t+e-1,this._editorCellsElems[t].innerHTML=r,this._editorCellsElems[t].setAttribute("data-cellIndex",r),1===this._aRowBinary[r]?n.push(this._editorCellsElems[t].classList.add(DOM.getClass("TOPROWEDITOR","EDITOR_CELL_ACTIVE"))):n.push(this._editorCellsElems[t].classList.remove(DOM.getClass("TOPROWEDITOR","EDITOR_CELL_ACTIVE")));return n},e.prototype._buildEditorCells=function(){var e,t,r,i,o,n,l,s,a,c,d;for(this._jEditorContainer.style.width=this._sliderCols*this._editorCellWidth+"px",t="",e=o=1,s=this._sliderCols;1<=s?o<=s:o>=s;e=1<=s?++o:--o)d="editor-cell-"+e,l=(e-1)*this._editorCellWidth,t+=templates["rowed-editor-cell"].render({id:d,left:l});for(this._jEditorContainer.innerHTML=t,r=document.getElementsByClassName(DOM.getClass("TOPROWEDITOR","EDITOR_CELL")),c=[],i=n=0,a=r.length-1;0<=a?n<=a:n>=a;i=0<=a?++n:--n)this._editorCellsElems[i+1]=r[i],c.push(r[i].addEventListener("click",this._toggleEditorCell));return c},e.prototype._toggleEditorCell=function(e){var t,r,i,o;return r=e.target,t=r.getAttribute("data-cellIndex"),o=DOM.getPrefix("TOPROWEDITOR","SLIDER_COL"),i=document.getElementById(o+t),1===this._aRowBinary[t]?(this._aRowBinary[t]=0,r.classList.remove(DOM.getClass("TOPROWEDITOR","EDITOR_CELL_ACTIVE")),i.classList.remove(DOM.getClass("TOPROWEDITOR","SLIDER_CELL_ACTIVE"))):(this._aRowBinary[t]=1,r.classList.add(DOM.getClass("TOPROWEDITOR","EDITOR_CELL_ACTIVE")),i.classList.add(DOM.getClass("TOPROWEDITOR","SLIDER_CELL_ACTIVE"))),this.BUS.set("toprowbinary",this._aRowBinary)},e.prototype._generateInitialBinary=function(){var e,t,r,i;for(i=Math.ceil(this._noColumns/2),e=t=1,r=this._noColumns;1<=r?t<=r:t>=r;e=1<=r?++t:--t)this._aRowBinary[e]=e===i?1:0;return this.BUS.set("toprowbinary",this._aRowBinary)},e.prototype._buildRow=function(){var e,t,r,i,o,n,l,s;for(l=DOM.getPrefix("TOPROWEDITOR","SLIDER_COL"),n="",t=r=1,o=this._noColumns;1<=o?r<=o:r>=o;t=1<=o?++r:--r)e="",1===this._aRowBinary[t]&&(e=DOM.getClass("TOPROWEDITOR","SLIDER_CELL_ACTIVE")),i=(t-1)*this._colWidth,s=l+t,n+=templates["rowed-slider-cell"].render({id:s,left:i,activeClass:e});return this._rowContainerElem.innerHTML=n},e}();var WolfCage;WolfCage=function(){function e(e){var t,r;this.BUS=new Bus,this.BUS.set("thumbnails.path",e.thumbnails_path),this.BUS.set("board.style.borderColor","#000000"),this.BUS.set("board.cell.style.activeBackgroundColor","#000000"),this.BUS.set("board.cell.style.borderColor","#000000"),this.BUS.set("board.cell.style.inactiveBackgroundColor","#ffffff"),r=new Tabs(this.BUS),new Thumbnails(this.BUS),new TopRowEditor(this.BUS),t=new MultiColorPicker(this.BUS),new Generator(this.BUS,t),r.start()}return e}();